{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 19,
  "summary": "Build an e-commerce marketplace app similar to Flipkart, branded as Buyflow, with purchasing restricted to users in India only.",
  "architectural_notes": [
    "Add country/region eligibility check during checkout (India-only purchasing).",
    "Admin navigation entry should be conditionally rendered only when the authenticated principal is in the backend-configured admin principals list; ensure frontend’s admin check is aligned with backend authorization logic.",
    "Admin access fix path: capture the signed-in user’s actual Internet Identity principal (not email) from the UI/profile and add it to the backend-configured admin principals list, then redeploy.",
    "User provided their Internet Identity principal string (7gpjj-tsxl6-4jq6z-brz3k-swflj-25zaz-xg5cz-e2omd-sh3pq-kqmao-hae); next step is to add it to the backend-configured admin principals list and redeploy so the Admin nav/panel access aligns end-to-end.",
    "Admin route (/admin) currently renders only the caller principal as a placeholder; build and render the full product-management admin UI (list/add/edit, images, categories, price, stock)."
  ],
  "known_issues": [
    "Admin user signs in but does not see the Admin button/link or access to the Admin panel (possible admin principal mismatch or UI admin-check not recognizing the user).",
    "User reported Admin panel still not appearing; user provided an email address as \"principal id\"—may indicate confusion or inability to view/copy the actual Internet Identity principal, leading to continued admin principal mismatch.",
    "Admin panel currently only shows the signed-in principal ID; full product-management admin UI is missing/not rendered."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-create-an-e-commerce-mvp-that-supports-browsing-a-product-catalog-by-category-searching-products-viewing-product-details-adding-removing-items-in-a-cart-completing-a-checkout-no-external-payment-and-viewing-past-orders",
      "title": "Create an e-commerce MVP that supports: browsing a product catalog by category, searching products, viewing product details, adding/removing items in a cart, completing a checkout (no external payment), and viewing past orders.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-internet-identity-authentication-and-require-sign-in-to-checkout-and-to-view-orders-allow-browsing-searching-products-without-signing-in",
      "title": "Implement Internet Identity authentication and require sign-in to checkout and to view Orders; allow browsing/searching products without signing in.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-frontend-build-core-pages-components-home-categories-featured-products-product-listing-category-search-results-product-detail-images-price-description-add-to-cart-cart-edit-quantities-remove-checkout-shipping-address-form-order-summary-place-order-orders-list-details-use-react-query-for-all-backend-data-access",
      "title": "Frontend: Build core pages/components: Home (categories + featured products), Product Listing (category + search results), Product Detail (images, price, description, add to cart), Cart (edit quantities/remove), Checkout (shipping address form + order summary + place order), Orders (list + details). Use React Query for all backend data access.",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-create-an-admin-only-product-management-flow-restricted-to-a-fixed-list-of-admin-principals-configured-in-backend-code-add-product-update-product-and-update-stock-ui-can-be-a-simple-hidden-route-or-a-basic-admin-page",
      "title": "Create an Admin-only product management flow restricted to a fixed list of admin principals (configured in backend code): add product, update product, and update stock. UI can be a simple hidden route or a basic admin page.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-coherent-original-visual-theme-for-a-flipkart-like-marketplace-ui-not-using-a-blue-purple-palette-define-consistent-colors-typography-spacing-and-component-styling-across-all-pages-using-tailwind-and-existing-ui-components",
      "title": "Apply a coherent, original visual theme for a Flipkart-like marketplace UI (not using a blue+purple palette): define consistent colors, typography, spacing, and component styling across all pages using Tailwind and existing UI components.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-add-generated-images-to-the-frontend-as-static-assets-under-frontend-public-assets-generated-and-use-them-in-the-ui-for-branding-and-categories-products",
      "title": "Add generated images to the frontend as static assets under frontend/public/assets/generated and use them in the UI for branding and categories/products.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-frontend-update-the-checkout-page-to-allow-the-user-to-select-a-payment-method-with-cash-on-delivery-cod-available-and-require-a-selection-before-placing-the-order",
      "title": "Frontend: Update the Checkout page to allow the user to select a payment method, with Cash on Delivery (COD) available, and require a selection before placing the order.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-frontend-display-the-selected-payment-method-on-order-related-screens-so-users-can-see-how-they-will-pay-orders-list-card-order-details-and-order-confirmation",
      "title": "Frontend: Display the selected payment method on order-related screens so users can see how they will pay (Orders list card, Order details, and Order confirmation).",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-rebrand-the-storefront-name-to-buyflow-across-all-visible-branding-and-browser-metadata-replacing-the-current-shophub-name-wherever-it-appears-e-g-header-brand-text-logo-alt-text-footer-copyright-and-the-html-document-title",
      "title": "Rebrand the storefront name to “Buyflow” across all visible branding and browser metadata, replacing the current “ShopHub” name wherever it appears (e.g., header brand text, logo alt text, footer copyright, and the HTML document title).",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-checkout-shipping-address-collection-to-explicitly-include-a-country-field-and-block-checkout-unless-the-country-is-india-show-a-clear-user-facing-error-message-when-the-user-attempts-to-place-an-order-with-a-non-india-country",
      "title": "Update the checkout shipping address collection to explicitly include a Country field and block checkout unless the Country is “India”. Show a clear, user-facing error message when the user attempts to place an order with a non-India country.",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-add-static-seo-discoverability-files-for-buyflow-so-search-engines-can-crawl-the-site-when-it-is-hosted-at-a-public-url-e-g-icp-domain-or-custom-domain-include-a-robots-txt-that-allows-crawling-and-a-sitemap-xml-that-lists-the-main-routes-products",
      "title": "Add static SEO/discoverability files for Buyflow so search engines can crawl the site when it is hosted at a public URL (e.g., ICP domain or custom domain): include a robots.txt that allows crawling, and a sitemap.xml that lists the main routes (/, /products).",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-html-metadata-for-sharing-and-indexing-by-adding-standard-meta-tags-to-the-html-entry-point-meta-description-canonical-url-support-and-open-graph-basic-tags-title-description-url-using-the-buyflow-brand-name-and-english-text",
      "title": "Improve HTML metadata for sharing and indexing by adding standard meta tags to the HTML entry point: meta description, canonical URL support, and Open Graph basic tags (title, description, url) using the Buyflow brand name and English text.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-simple-user-facing-page-or-section-in-the-ui-that-shows-the-app-s-current-public-url-origin-and-provides-a-one-click-copy-url-action-so-users-can-open-buyflow-directly-in-any-browser-chrome-safari-firefox-without-needing-someone-to-send-them-a-link-manually",
      "title": "Add a simple user-facing page or section in the UI that shows the app’s current public URL (origin) and provides a one-click “Copy URL” action so users can open Buyflow directly in any browser (Chrome/Safari/Firefox) without needing someone to send them a link manually.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-in-app-help-section-english-that-explains-what-is-required-to-make-buyflow-discoverable-on-google-search-e-g-submit-the-public-url-in-google-search-console-and-clarify-that-a-custom-domain-dns-setup-is-outside-the-app-code-but-the-app-provides-the-needed-seo-files-and-metadata",
      "title": "Add an in-app help section (English) that explains what is required to make Buyflow discoverable on Google Search (e.g., submit the public URL in Google Search Console) and clarify that a custom domain/DNS setup is outside the app code but the app provides the needed SEO files and metadata.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-in-app-help-page-to-include-a-new-section-titled-how-to-add-products-that-explains-in-english-how-an-admin-can-add-edit-manage-products-in-buyflow-using-the-existing-admin-panel-at-route-admin-the-section-must-clearly-state-that-only-admin-accounts-can-access-the-admin-panel-and-that-non-admin-users-will-see-an-access-denied-screen",
      "title": "Update the in-app Help page to include a new section titled \"How to add products\" that explains, in English, how an admin can add/edit/manage products in Buyflow using the existing Admin Panel at route \"/admin\". The section must clearly state that only admin accounts can access the Admin Panel and that non-admin users will see an \"Access Denied\" screen.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-discoverability-of-the-existing-admin-panel-by-adding-an-admin-navigation-entry-that-is-only-visible-to-authenticated-admin-users-when-the-current-user-is-an-admin-show-an-admin-link-button-in-the-main-header-navigation-that-routes-to-admin-when-not-an-admin-do-not-show-the-link",
      "title": "Improve discoverability of the existing Admin Panel by adding an Admin navigation entry that is only visible to authenticated admin users. When the current user is an admin, show an \"Admin\" link/button in the main header navigation that routes to \"/admin\"; when not an admin, do not show the link.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-admin-navigation-entry-is-visible-to-authenticated-admin-users-on-all-screen-sizes-including-mobile-and-routes-to-admin-when-clicked",
      "title": "Ensure the \"Admin\" navigation entry is visible to authenticated admin users on all screen sizes (including mobile), and routes to \"/admin\" when clicked.",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    },
    {
      "id": "feature-make-admin-detection-reliable-end-to-end-so-that-admin-users-are-recognized-by-the-frontend-useiscalleradmin-and-can-access-admin-only-product-management-apis-fix-any-mismatch-between-the-configured-admin-principals-and-the-active-internet-identity-principal",
      "title": "Make admin detection reliable end-to-end so that admin users are recognized by the frontend (useIsCallerAdmin) and can access admin-only product management APIs; fix any mismatch between the configured admin principals and the active Internet Identity principal.",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-authenticated-user-ui-affordance-that-clearly-displays-the-currently-signed-in-internet-identity-principal-id-the-full-principal-string-and-provides-a-one-click-copy-to-clipboard-action",
      "title": "Add an authenticated-user UI affordance that clearly displays the currently signed-in Internet Identity principal ID (the full principal string) and provides a one-click copy-to-clipboard action.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-in-app-help-page-to-include-an-english-section-explaining-how-to-find-and-copy-the-internet-identity-principal-id-explicitly-clarifying-that-an-email-address-is-not-a-principal-id-and-that-admin-access-requires-the-principal-string",
      "title": "Update the in-app Help page to include an English section explaining how to find and copy the Internet Identity principal ID, explicitly clarifying that an email address is not a principal ID and that admin access requires the principal string.",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-admin-route-renders-a-full-admin-panel-product-management-experience-not-a-placeholder-view-that-only-shows-the-signed-in-principal-id-including-1-an-add-edit-product-form-and-2-a-manage-products-list-for-editing-and-stock-updates-access-must-remain-restricted-via-the-existing-admingate-so-non-admin-users-see-an-access-denied-screen",
      "title": "Ensure the \"/admin\" route renders a full Admin Panel product-management experience (not a placeholder view that only shows the signed-in principal ID), including: (1) an Add/Edit Product form and (2) a Manage Products list for editing and stock updates; access must remain restricted via the existing AdminGate so non-admin users see an \"Access Denied\" screen.",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-upgrade-the-admin-panel-add-edit-product-form-to-support-a-full-workflow-for-product-fields-already-supported-by-the-backend-title-description-price-currency-category-imageurl-rating-optional-and-stock-add-admin-friendly-ux-features-inline-validation-with-clear-english-error-messages-an-image-preview-for-the-entered-imageurl-and-category-assistance-suggest-existing-categories-from-the-catalog-while-still-allowing-free-text-entry",
      "title": "Upgrade the Admin Panel Add/Edit Product form to support a \"full\" workflow for product fields already supported by the backend: title, description, price, currency, category, imageUrl, rating (optional), and stock. Add admin-friendly UX features: inline validation with clear English error messages, an image preview for the entered imageUrl, and category assistance (suggest existing categories from the catalog while still allowing free-text entry).",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-upgrade-the-admin-panel-manage-products-view-to-better-support-ongoing-catalog-management-by-adding-loading-empty-states-an-at-a-glance-product-thumbnail-from-imageurl-and-safer-stock-editing-ux-validate-numeric-input-avoid-sending-invalid-empty-values-keep-all-user-facing-text-in-english",
      "title": "Upgrade the Admin Panel \"Manage Products\" view to better support ongoing catalog management by adding: loading/empty states, an at-a-glance product thumbnail (from imageUrl), and safer stock editing UX (validate numeric input; avoid sending invalid/empty values). Keep all user-facing text in English.",
      "reqIds": [
        "REQ-30"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Create an e-commerce app similar to Flipkart (product catalog, search/browse, cart, checkout, orders, user accounts).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Backend: Add stable data models and CRUD/query methods for Products (id, title, description, price, currency, category, imageUrl, rating optional, stock), and expose query endpoints for: list all, list by category, search by keyword, and get by id.",
      "reqIds": [
        "REQ-3"
      ],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Backend: Implement per-user Cart functionality keyed by caller principal, including methods to get cart, add item (productId, quantity), update quantity, remove item, and clear cart; validate product existence and enforce stock limits.",
      "reqIds": [
        "REQ-4"
      ],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Backend: Implement Orders with method placeOrder(shippingAddress fields, cart snapshot) that converts the caller’s cart into an order, decreases stock, clears the cart, and returns an order id; provide listMyOrders() and getOrder(orderId) restricted to the order owner.",
      "reqIds": [
        "REQ-5"
      ],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Seed the app with an initial catalog of sample products across multiple categories (e.g., Electronics, Fashion, Home, Beauty) so the UI is usable immediately after deployment.",
      "reqIds": [
        "REQ-7"
      ],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Add a payment method option to checkout: Cash on Delivery (COD), allowing users to place orders with COD selected and reflecting it on order records/details.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Backend: Add a payment method field to the Order record and persist it when placing an order, supporting at least the Cash on Delivery (COD) option.",
      "reqIds": [
        "REQ-11"
      ],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Restrict purchasing/checkout to Indian users only; block users from other countries from buying products.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "Enforce India-only purchasing on the backend by validating order placement requests and rejecting any order that is not for India. The backend must not rely solely on frontend checks for this restriction.",
      "reqIds": [
        "REQ-16"
      ],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Set up a public Buyflow website URL (e.g., custom domain/short easy-to-remember URL) so users can access it in any browser without direct link sharing, and enable discoverability via Google Search indexing.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Update the backend’s fixed admin-principals configuration to include the Internet Identity principal \"7gpjj-tsxl6-4jq6z-brz3k-swflj-25zaz-xg5cz-e2omd-sh3pq-kqmao-hae\", so this signed-in user is recognized as an admin and can access admin-only product management APIs and the /admin UI.",
      "reqIds": [
        "REQ-27"
      ],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Implement a full Admin Panel UI (beyond showing principal ID) including product management tools: list/add/edit products with images, price, stock, categories, and related fields.",
      "reqIds": [],
      "status": "in_progress"
    }
  ],
  "projectName": "Buyflow",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}